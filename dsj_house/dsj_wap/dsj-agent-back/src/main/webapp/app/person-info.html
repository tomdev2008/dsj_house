<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script type="text/javascript" src="js/fles.js"></script>
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>大搜家-经纪人</title>

    <link rel="icon" href="img/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/dsj_agent.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
      <script src="js/respond.src.js"></script>
    <![endif]-->
  </head>
  <body>
    <!-- 主体 -->
    <div class="container">
      <div class="row">
        <div class="col-sm-2">
          <ul class="nav nav-pills nav-stacked nav-pills-stacked-example dsj_left_nav">
            <li role="presentation"  class="active"><a>基本资料</a></li>
            <li role="presentation"><a href="person-avatar.html">个人头像</a></li>
            <li role="presentation"><a href="person-occupation.html">职业信息</a></li>
            <li role="presentation"><a href="person-password.html">修改密码</a></li>
            <li role="presentation"><a href="person-phone.html">修改手机号</a></li>
            <li role="presentation"><a href="person-background.html">个人主页背景管理</a></li>
            <li role="presentation"><a href="person-mygrade.html">我的等级</a></li>
            <li role="presentation"><a href="person-qp-evaluate.html">评价二维码</a></li>
          </ul>
        </div>
        <div id="dsj_info_container" class="col-sm-10">
        </div>
      </div>


    </div>
    <script id="dsj_info_template" type="text/x-handlebars-template">
      <form class="form-horizontal dsj_form">
        <h4 class="dsj_title">基本资料</h4>
        <div class="form-group">
          <label for="beianbianhao" class="col-sm-1 control-label">真实姓名：</label>
          <div class="col-sm-3">
            <input type="text" class="form-control" maxLength="5" name="name" value="{{name}}">
          </div>
        </div>
        <div class="form-group">
          <label for="inputPassword" class="col-sm-1 control-label">手机号：</label>
          <div class="col-sm-3">
            <p class="form-control-static">{{tellPhone}}<a class="dst_line_action" href="person-phone.html">修改</a></p>
          </div>
        </div>
        <div class="form-group">
          <label for="inputPassword" class="col-sm-1 control-label">血型：</label>
          <div class="col-sm-3">
            <select class="form-control" name="blood" style="width:80px">
              	{{#each bloodArray}}	
                  	<option value="{{this}}" {{{selectBlood this}}}>{{this}}</option>          	
　 				{{/each}}
            </select>
          </div>
        </div>
        <div class="form-group">
          <label for="inputPassword" class="col-sm-1 control-label">邮箱：</label>
          <div class="col-sm-3">
            <input type="text" class="form-control" name="email" id="inputPassword" value="{{email}}" >
          </div>
        </div>
        <div class="form-group">
          <label for="inputPassword" class="col-sm-1 control-label">学历：</label>

          <div class="col-sm-3">
            <select class="form-control" name="education" style="width:150px">
				
               {{#each eduArray}}	
                  	<option value="{{this}}" {{{selectEdu this}}}>{{this}}</option>          	
　 				{{/each}}
            </select>
          </div>
        </div>

    <div class="form-group">
          <label for="inputPassword" class="col-sm-1 control-label">专业：</label>
          <div class="col-sm-3">
            <input type="text" name="major" class="form-control" id="inputPassword" value="{{major}}" >
          </div>
        </div>
        <div class="form-group">
          <label for="text" class="col-sm-1 control-label">个人签名：</label>
          <div class="col-sm-10">
            <textarea id="text" name="signature"class="form-control" rows="3">{{signature}}</textarea>
          </div>
        </div>
		<div class="row dsj_button_group">
            <div class="col-sm-5">
              <input class="btn dsj_button btn-primary" type="button" onclick="save({{id}})" value="确认">
              <input class="btn dsj_button btn-default" type="button" onclick="cancle()" value="取消">
            </div>
          </div>
      </form>
    </script>
    <script id="dsj_info_verify_template" type="text/x-handlebars-template">
      <form class="form-horizontal dsj_form">
        <h4 class="dsj_title">基本资料</h4>
        <div class="form-group">
          <label for="beianbianhao" class="col-sm-1 control-label">真实姓名：</label>
          <div class="col-sm-3">
            <p class="form-control-static">{{name}}</p>
          </div>
        </div>
        <div class="form-group">
          <label for="" class="col-sm-1 control-label">手机号：</label>
          <div class="col-sm-3">
            <p class="form-control-static">{{tellPhone}}<a class="dst_line_action" href="person-phone.html">修改</a></p>
          </div>
        </div>
        <div class="form-group" {{{hide mobile}}}>
          <label for="" class="col-sm-1 control-label">400电话：</label>
          <div class="col-sm-3">
            <p class="form-control-static">400-8986868-{{mobile}}</p>
          </div>
        </div>
        <div class="form-group">
          <label for="" class="col-sm-1 control-label">性别：</label>
          <div class="col-sm-3">
            <p class="form-control-static">{{sex}}</p>
          </div>

        </div>
        <div class="form-group">
          <label for="" class="col-sm-1 control-label">生日：</label>
          <p class="form-control-static">{{birthday}}</p>
        </div>
		  <div class="form-group">
          <label for="inputPassword" class="col-sm-1 control-label">星座：</label>
          <div class="col-sm-3">
            <p class="form-control-static">{{star}}
          </div>
        </div>
        <div class="form-group">
          <label for="inputPassword" class="col-sm-1 control-label">血型：</label>
          <div class="col-sm-1">
            <select class="form-control" name="blood"style="width:80px">
      			{{#each bloodArray}}	
                  	<option value="{{this}}" {{{selectBlood this}}}>{{this}}</option>          	
　 				{{/each}}
      			</select>
          </div>
        </div>
        <div class="form-group">
          <label for="inputPassword" class="col-sm-1 control-label">邮箱：</label>
          <div class="col-sm-3">
            <input type="text" class="form-control" name="email" id="inputPassword" value="{{email}}" >
          </div>
        </div>
        <div class="form-group">
          <label for="inputPassword" class="col-sm-1 control-label">学历：</label>
          <div class="col-sm-1">
            <select class="form-control" name="education" style="width:150px">
              {{#each eduArray}}	
                  	<option value="{{this}}" {{{selectEdu this}}}>{{this}}</option>          	
　 				{{/each}}
            </select>
          </div>
        </div>

		<div class="form-group">
          <label for="inputPassword"  class="col-sm-1 control-label">专业：</label>
          <div class="col-sm-3">
            <input type="text" name="major" class="form-control" id="inputPassword" value="{{major}}" >
          </div>
        </div>
        <div class="form-group">
          <label for="text" class="col-sm-1 control-label">个人签名：</label>
          <div class="col-sm-10">
            <textarea id="text"  name="signature" class="form-control" rows="3">{{signature}}</textarea>
          </div>
        </div>
		<div class="row dsj_button_group">
            <div class="col-sm-5">
              <input class="btn dsj_button btn-primary" type="button" onclick="save({{id}})" value="确认">
              <input class="btn dsj_button btn-default" type="button" onclick="cancle()" value="取消">
            </div>
          </div>
      </form>
    </script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery.js"></script>
    <!-- <script src="http://cdn.bootcss.com/jquery/1.12.2/jquery.js"></script> -->
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.js"></script>
    <script src="js/handlebars.js"></script>
    <script src="js/require.js"></script>
    <script src="js/handlebars-utils.js"></script>
    <script src="js/common/header.js"></script>
    <script src="js/alertBox.js"></script>
    <script type="text/javascript">
    var currentEdu = '';
    var currentBlood = '';
    Handlebars.registerHelper({  
        'selectBlood' : function(p1) {//格式化时间  
			if(p1==currentBlood){
				return "selected='selected'";
			}else{
				return '';
			}
        },
        'selectEdu' : function(p1) {//格式化时间  
			if(p1==currentEdu){
				return "selected='selected'";
			}else{
				return '';
			}
        },
        "hide":function(p){
        	if(p==null||p==""){
        		return "style='display:none'";
        	}else{
        		return "";
        	}
        }
    }) 
    var userId= '';
	var sex = ["男","女"];
	var blood = ["A","B","O","其他"];
	var edu =["研究生及以上","本科","大专","高中及以下"];
    $(function () {   	  
		$.ajax({
			type:"post",
			url:_url+"/back/frame/system/agent/getAgentInfo",
			datatype:"json",
			data:{r:Math.random()},
			success:function(result){
				userId=result.data.userId;
				currentBlood=result.data.blood;
				currentEdu=result.data.education;
				if(result.data.auditStatus==4){
					var source   = $("#dsj_info_template").html();
			        var template = Handlebars.compile(source);
				}else{
					var source   = $("#dsj_info_verify_template").html();
			        var template = Handlebars.compile(source);
				}
				var option = result.data;
					option.eduArray = edu;
					option.bloodArray = blood;
				var html = template(option);
		        $("#dsj_info_container").prepend(html);
			}
		})
	})
	function save(id){
    	$.ajax({
            type: "post",
            url: _url+"/back/frame/system/agent/saveAgent",
            data: $("form").serialize()+"&id="+id+"&userId="+userId,
            dataType: "json",
            success: function(result){
              	if(result.status==200){
              		show_box(3,"修改成功");
              	}else{
              		show_box(2,result.message);
              	}
            }
          });

    }
    function cancle(){
    	window.location.href="agent-index.html";
    }
    require(["text!common/commit.html"], function(tpl) {
   	 $('body').append(tpl);
   	 var source=$("#dailog_common_template").html();
   	 var template = Handlebars.compile(source);
		 var html = template();
   	 $('body').append(html);
	}); 

    </script>
  </body>
</html>